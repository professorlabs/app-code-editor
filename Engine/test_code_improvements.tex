\\documentclass{article}
\\usepackage{amsmath}
\\title{Code Block Testing}
\\author{Test User}

\\begin{document}

\section{Testing Code Improvements}

\subsection{Single Language Code Blocks}
\begin{code}
bg-white
{python}
def fibonacci(n):
    """Calculate Fibonacci sequence"""
    if n <= 1:
        return n
    return fibonacci(n-1) + fibonacci(n-2)

print(fibonacci(10))
\end{code}

\subsection{Multiple Language Code Block with Tabs}
\begin{code}
bg-gray
title=Algorithm Examples
{python:Python}
def quicksort(arr):
    if len(arr) <= 1:
        return arr
    pivot = arr[len(arr) // 2]
    left = [x for x in arr if x < pivot]
    middle = [x for x in arr if x == pivot]
    right = [x for x in arr if x > pivot]
    return quicksort(left) + middle + quicksort(right)

{javascript:JavaScript}
function quicksort(arr) {
    if (arr.length <= 1) return arr;
    const pivot = arr[Math.floor(arr.length / 2)];
    const left = arr.filter(x => x < pivot);
    const middle = arr.filter(x => x === pivot);
    const right = arr.filter(x => x > pivot);
    return [...quicksort(left), ...middle, ...quicksort(right)];
}

{html:HTML}
<!DOCTYPE html>
<html>
<head>
    <title>Quicksort Demo</title>
    <style>
        .array { display: flex; gap: 5px; }
        .element { padding: 10px; background: #007bff; color: white; }
    </style>
</head>
<body>
    <div class="array" id="output"></div>
    <script src="quicksort.js"></script>
</body>
</html>
\end{code}

\subsection{Black Theme Code Block}
\begin{code}
bg-black
numbers
{java}
public class BinarySearch {
    public static int binarySearch(int[] arr, int target) {
        int left = 0;
        int right = arr.length - 1;
        
        while (left <= right) {
            int mid = left + (right - left) / 2;
            
            if (arr[mid] == target) {
                return mid;
            }
            
            if (arr[mid] < target) {
                left = mid + 1;
            } else {
                right = mid - 1;
            }
        }
        
        return -1;
    }
}
\end{code}

\subsection{C++ Code with Preprocessor}
\begin{code}
bg-white
{cpp}
#include <iostream>
#include <vector>
#include <algorithm>

#define MAX_SIZE 100

template<typename T>
class Stack {
private:
    std::vector<T> data;
    
public:
    void push(const T& item) {
        data.push_back(item);
    }
    
    T pop() {
        if (data.empty()) {
            throw std::runtime_error("Stack is empty");
        }
        T item = data.back();
        data.pop_back();
        return item;
    }
    
    bool empty() const {
        return data.empty();
    }
};

int main() {
    Stack<int> stack;
    stack.push(42);
    stack.push(24);
    
    while (!stack.empty()) {
        std::cout << stack.pop() << std::endl;
    }
    
    return 0;
}
\end{code}

\subsection{CSS Code Example}
\begin{code}
bg-gray
{css}
/* Modern CSS Grid Layout */
.container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
    padding: 2rem;
}

.card {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 12px;
    padding: 1.5rem;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    transition: transform 0.3s ease;
}

.card:hover {
    transform: translateY(-5px);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
}

@media (max-width: 768px) {
    .container {
        grid-template-columns: 1fr;
        padding: 1rem;
    }
}
\end{code}

\subsection{SQL Query Example}
\begin{code}
bg-black
{sql}
-- Complex query with joins and subqueries
SELECT 
    u.user_id,
    u.username,
    u.email,
    COUNT(o.order_id) as total_orders,
    SUM(o.total_amount) as total_spent,
    AVG(o.total_amount) as avg_order_value
FROM users u
LEFT JOIN orders o ON u.user_id = o.user_id
WHERE u.created_at >= '2023-01-01'
    AND o.status = 'completed'
GROUP BY u.user_id, u.username, u.email
HAVING COUNT(o.order_id) >= 5
ORDER BY total_spent DESC
LIMIT 100;
\end{code}

\subsection{Bash Script Example}
\begin{code}
bg-white
{bash}
#!/bin/bash

# Backup script with error handling
set -euo pipefail

BACKUP_DIR="/backup/$(date +%Y%m%d)"
SOURCE_DIR="/home/user/documents"
LOG_FILE="/var/log/backup.log"

log() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $1" | tee -a "$LOG_FILE"
}

create_backup() {
    if [[ ! -d "$SOURCE_DIR" ]]; then
        log "ERROR: Source directory does not exist: $SOURCE_DIR"
        exit 1
    fi
    
    mkdir -p "$BACKUP_DIR"
    log "Starting backup to $BACKUP_DIR"
    
    tar -czf "$BACKUP_DIR/backup.tar.gz" -C "$SOURCE_DIR" .
    log "Backup completed successfully"
}

cleanup_old_backups() {
    find /backup -type d -name "20*" -mtime +7 -exec rm -rf {} +
    log "Cleaned up old backups"
}

# Main execution
create_backup
cleanup_old_backups
\end{code}

\subsection{JSON Configuration}
\begin{code}
bg-gray
{json}
{
    "name": "latex2html-engine",
    "version": "1.0.0",
    "description": "Premium LaTeX to HTML conversion engine",
    "main": "engine.js",
    "scripts": {
        "start": "node engine.js",
        "test": "jest",
        "build": "webpack --mode=production",
        "dev": "webpack serve --mode=development"
    },
    "dependencies": {
        "express": "^4.18.2",
        "katex": "^0.16.8",
        "prismjs": "^1.29.0"
    },
    "devDependencies": {
        "@types/node": "^20.0.0",
        "typescript": "^5.0.0",
        "webpack": "^5.88.0"
    },
    "engines": {
        "node": ">=16.0.0"
    }
}
\end{code}

\end{document}